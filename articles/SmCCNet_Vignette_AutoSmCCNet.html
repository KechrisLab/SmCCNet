<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="SmCCNet">
<title>Automated SmCCNet • SmCCNet</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Automated SmCCNet">
<meta property="og:description" content="SmCCNet">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SmCCNet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/SmCCNet_Vignette_AutoSmCCNet.html">Automated SmCCNet</a>
    <a class="dropdown-item" href="../articles/SmCCNet_Vignette_MultiOmics.html">Reconstructing Phenotype-Specific Multi-Omics Networks with SmCCNet</a>
    <a class="dropdown-item" href="../articles/SmCCNet_Vignette_SingleOmics.html">Reconstructing Phenotype-Specific Single-Omics Networks with SmCCNet</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/KechrisLab/SmCCNet/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Automated SmCCNet</h1>
                        <h4 data-toc-skip class="author">Weixuan
Liu</h4>
                        <h4 data-toc-skip class="author">Katerina
Kechris</h4>
            
            <h4 data-toc-skip class="date">2024-01-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/KechrisLab/SmCCNet/blob/HEAD/vignettes/SmCCNet_Vignette_AutoSmCCNet.Rmd" class="external-link"><code>vignettes/SmCCNet_Vignette_AutoSmCCNet.Rmd</code></a></small>
      <div class="d-none name"><code>SmCCNet_Vignette_AutoSmCCNet.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="automated-smccnet">Automated SmCCNet<a class="anchor" aria-label="anchor" href="#automated-smccnet"></a>
</h2>
<p>In this version of the SmCCNet package, we introduce a pipeline known
as Automated SmCCNet. This method streamlines the SmCCNet code and
significantly reduces computation time. Users are simply required to
input a list of omics data and a phenotype variable. The program then
automatically determines whether it is dealing with a single-omics or
multi-omics problem, and whether to use CCA or PLS for quantitative or
binary phenotypes respectively. For details of how each method is
established and how parameters and coefficients are set, we recommend
the user to refer to the multi-omics and single-omics vignettes.</p>
<p>Specifically, for multi-omics SmCCNet, if CCA is employed, the
program can automatically select the scaling factors (importance of the
pair-wise omics or omics-phenotype correlations to the objective
function). This is achieved by calculating the pairwise canonical
correlation between each pair of omics under the most stringent penalty
parameters. The scaling factor for the omics data A, B pair in SmCCA is
set to the absolute value of the pairwise canonical correlation between
omics A and B divided by the between omics correlation shrinkage
parameter. By default, all scaling factors linked to the
phenotype-specific correlation structure are set to 1. In Automated
SmCCNet, users only need to provide a BetweenShrinkage parameter, a
positive real number that helps reduce the significance of the
omics-omics correlation component. The larger this number, the more the
between omics correlation is shrunk.</p>
<p>Moreover, for multi-omics SmCCNet with a binary phenotype, the
scaling factor is not implemented. However, the user need to provide
values for <span class="math inline">\(\gamma_1\)</span> (omics-omics
connection importance) and <span class="math inline">\(\gamma_2\)</span>
(omics-phenotype connection importance, see multi-omics vignette section
5 for detail). The automated SmCCNet program offers a method to
calculate <span class="math inline">\(\gamma_1\)</span> while setting
the value of <span class="math inline">\(\gamma_2\)</span> to 1. This is
generally done by averaging all the pairwise omics-omics canonical
correlations in the multi-omics dataset.</p>
<p>The program can also automatically select the percentage of features
subsampled. If the number of features from an omics data is less than
300, then the percentage of feature subsampled is set to 0.9, otherwise,
it’s set to 0.7. The candidate penalty terms range from 0.1 to 0.5 with
a step size of 0.1 for single/multi-omics SmCCA, and from 0.5 to 0.9
with a step size of 0.1 for single/multi-omics SPLSDA (for both
omics-omics SmCCA step and omics-phenotype classifier, see section 5 in
multi-omics vignette for detail).</p>
<p>This automated version of SmCCNet is typically faster than the
standard SmCCNet. This is due to the heuristic selection of the scaling
factors (see section 4.2 in the multi-omics vignette), and the
parallelization of the cross-validation step, resulting in a substantial
increase in computational speed. Below is an example of how to implement
Automated SmCCNet. For more detailed information, please refer to the
<strong>FastAutoSmCCNet()</strong> function help file:</p>
</div>
<div class="section level2">
<h2 id="function-arguments-and-tuning-parameters">Function Arguments and Tuning Parameters<a class="anchor" aria-label="anchor" href="#function-arguments-and-tuning-parameters"></a>
</h2>
<p><strong>X</strong>: A list of omics matrices with same set and order
of subjects</p>
<p><strong>Y</strong>: Phenotype variable of either numeric or binary,
for binary variable, for binary Y, it should be binarized to 0 and 1
before running this function.</p>
<p><strong>AdjustedCovar</strong>: A data frame of covariates of
interest to be adjusted for through regressing-out approach,
<strong>preprocess</strong> must be set to TRUE.</p>
<p><strong>Kfold</strong>: Number of folds for cross-validation, default
is set to 5.</p>
<p><strong>EvalMethod</strong>: For single or multi-omics with binary
phenotype, the evaluation methods used to selected the optimal penalty
parameter(s). The selections is among ‘accuracy’, ‘auc’, ‘precision’,
‘recall’, and ‘f1’, default is set to ‘accuracy’.</p>
<p><strong>subSampNum</strong>: Number of subsampling to run, the higher
the better in terms of accuracy, but at a cost of computational time, we
generally recommend 500-1000 to increase robustness.</p>
<p><strong>BetweenShrinkage</strong>: A real number &gt; 0 that helps
shrink the importance of omics-omics correlation component, the larger
this number is, the greater the shrinkage it is, default is set to
2.</p>
<p><strong>ScalingPen</strong>: A numeric vector of length 2 used as the
penalty terms for scaling factor selection method, default set to 0.1,
and should be between 0 and 1.</p>
<p><strong>DataType</strong>: A vector indicating omics type for each
element of X, example would be c(‘gene’, ‘miRNA’).</p>
<p><strong>CutHeight</strong>: A numeric value specifying the cut height
for hierarchical clustering, should be between 0 and 1, default is set
to <span class="math inline">\(1-0.1^{10}\)</span>.</p>
<p><strong>min_size</strong>: Minimally possible subnetwork size after
network pruning, default set to 10.</p>
<p><strong>max_size</strong>: Maximally possible subnetwork size after
network pruning, default set to 100.</p>
<p><strong>summarization</strong>: Summarization method used for network
pruning and summarization, should be either ‘NetSHy’ or ‘PCA’, default
is set to ‘NetSHy’.</p>
<p><strong>saving_dir</strong>: Directory where user would like to store
the subnetwork results, default is set to the current working
directory.</p>
<p><strong>preprocess</strong>: TRUE or FALSE, Whether the data
preprocessing step should be conducted, default is set to FALSE. If
covariates adjustment is needed, add covariates to the
<strong>AdjustedCovar</strong> argument.</p>
<p><strong>ncomp_pls</strong>: Number of components for PLS algorithm,
only used when binary phenotype is given, default is set to 3.</p>
<p><strong>tuneLength</strong>: The total number of candidate penalty
term values for each omics data, default is set to 5.</p>
<p><strong>tuneRangeCCA</strong>: A vector of length 2 that represents
the range of candidate penalty term values for each omics data based on
canonical correlation analysis, default is set to c(0.1,0.5).</p>
<p><strong>tuneRangePLS</strong>: A vector of length 2 that represents
the range of candidate penalty term values for each omics data based on
partial least squared discriminant analysis, default is set to
c(0.5,0.9).</p>
<p><strong>seed</strong>: Random seed for result reproducibility,
default is set to 123.</p>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>We present below examples of how to execute Automated SmCCNet using a
simulated dataset. In this demonstration, we simulate four datasets: two
omics data and one phenotype data. We cover four cases in total,
involving combinations of single or multi-omics data with either a
quantitative or binary phenotype. The final case demonstrates the use of
the regress-out approach for covariate adjustment. If users want to run
through the pipeline step-by-step or understand more about the algorithm
used, please refer to SmCCNet single or multi-omics vignettes for
details.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/KechrisLab/SmCCNet" class="external-link">SmCCNet</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ExampleData"</span><span class="op">)</span></span>
<span><span class="va">Y_binary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">Y</span>, <span class="fl">0.5</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co"># single-omics PLS</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fastAutoSmCCNet.html">fastAutoSmCCNet</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">X1</span><span class="op">)</span>, Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Y_binary</span><span class="op">)</span>, </span>
<span>                          Kfold <span class="op">=</span> <span class="fl">3</span>, </span>
<span>                          subSampNum <span class="op">=</span> <span class="fl">100</span>, DataType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Gene'</span><span class="op">)</span>,</span>
<span>                          saving_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>, EvalMethod <span class="op">=</span> <span class="st">'auc'</span>, </span>
<span>                          summarization <span class="op">=</span> <span class="st">'NetSHy'</span>, </span>
<span>                          CutHeight <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="fl">0.1</span><span class="op">^</span><span class="fl">10</span>, ncomp_pls <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co"># single-omics CCA</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fastAutoSmCCNet.html">fastAutoSmCCNet</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">X1</span><span class="op">)</span>, Y <span class="op">=</span> <span class="va">Y</span>, Kfold <span class="op">=</span> <span class="fl">3</span>, </span>
<span>                          preprocess <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                          subSampNum <span class="op">=</span> <span class="fl">50</span>, DataType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Gene'</span><span class="op">)</span>,</span>
<span>                          saving_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>, summarization <span class="op">=</span> <span class="st">'NetSHy'</span>,</span>
<span>                          CutHeight <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="fl">0.1</span><span class="op">^</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co"># multi-omics PLS</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fastAutoSmCCNet.html">fastAutoSmCCNet</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">X1</span>,<span class="va">X2</span><span class="op">)</span>, Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Y_binary</span><span class="op">)</span>, </span>
<span>                          Kfold <span class="op">=</span> <span class="fl">3</span>, subSampNum <span class="op">=</span> <span class="fl">50</span>, </span>
<span>                          DataType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Gene'</span>, <span class="st">'miRNA'</span><span class="op">)</span>, </span>
<span>                          CutHeight <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="fl">0.1</span><span class="op">^</span><span class="fl">10</span>,</span>
<span>                          saving_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>                          EvalMethod <span class="op">=</span> <span class="st">'auc'</span>, </span>
<span>                          summarization <span class="op">=</span> <span class="st">'NetSHy'</span>,</span>
<span>                          BetweenShrinkage <span class="op">=</span> <span class="fl">5</span>, </span>
<span>                          ncomp_pls <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co"># multi-omics CCA</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fastAutoSmCCNet.html">fastAutoSmCCNet</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">X1</span>,<span class="va">X2</span><span class="op">)</span>, Y <span class="op">=</span> <span class="va">Y</span>, </span>
<span>                          K <span class="op">=</span> <span class="fl">3</span>, subSampNum <span class="op">=</span> <span class="fl">50</span>, </span>
<span>                          DataType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Gene'</span>, <span class="st">'miRNA'</span><span class="op">)</span>, </span>
<span>                          CutHeight <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="fl">0.1</span><span class="op">^</span><span class="fl">10</span>,</span>
<span>                          saving_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>,  </span>
<span>                          summarization <span class="op">=</span> <span class="st">'NetSHy'</span>,</span>
<span>                          BetweenShrinkage <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p>Global network information will be stored in object ‘result’, and
subnetwork information will be stored in the directory user provide. For
more information about using Cytoscape to visualize the subnetworks,
please refer back to the multi-omics vignette section 3.1.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Weixuan Liu.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
